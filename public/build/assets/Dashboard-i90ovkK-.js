import{r as i,x as _,j as e,Q as H,t as C,S as o}from"./app-C3tjtM9t.js";import{S as O}from"./Statistics-IY_mgSnc.js";import{S as k}from"./StatusBadge-FdBs2LQL.js";import{P as h}from"./PrimaryButton-CFSDqQw7.js";import{S as g}from"./SecondaryButton-CVnl6mFh.js";import{M as p}from"./Modal-BVMrYtsw.js";import"./transition-Cd-WLyPi.js";function K({stats:c,nextAppointments:j,statsByDay:z,appointments:r,filters:t}){const[D,x]=i.useState(!1),[S,m]=i.useState(!1),[R,u]=i.useState(!1),[l,n]=i.useState(null),[b,y]=i.useState(""),[f,N]=i.useState(""),a=_({status:(t==null?void 0:t.status)||"",priority:(t==null?void 0:t.priority)||"",date_from:(t==null?void 0:t.date_from)||"",date_to:(t==null?void 0:t.date_to)||"",search:(t==null?void 0:t.search)||"",sort_by:(t==null?void 0:t.sort_by)||"created_at",sort_order:(t==null?void 0:t.sort_order)||"desc"}),d=_({admin_notes:"",preferred_date:"",preferred_time:""}),A=()=>{a.get(route("dashboard"))},M=()=>{a.reset(),o.get(route("dashboard"))},T=()=>{if(!b.trim()){alert("Veuillez indiquer une raison de refus.");return}o.post(route("admin.appointments.reject",l.id),{rejection_reason:b}),x(!1),n(null),y("")},F=()=>{if(!f.trim()){alert("Veuillez indiquer une raison d'annulation.");return}o.post(route("admin.appointments.cancel",l.id),{admin_notes:f}),m(!1),n(null),N("")},q=s=>{confirm("Êtes-vous sûr de vouloir accepter ce rendez-vous ?")&&o.post(route("admin.appointments.accept",s.id))},V=()=>{d.put(route("admin.appointments.update",l.id),{onSuccess:()=>{u(!1),n(null),d.reset()}})},E=s=>{n(s),x(!0)},w=s=>{n(s),m(!0)},P=s=>{n(s),d.setData({admin_notes:s.admin_notes||"",preferred_date:s.preferred_date,preferred_time:s.preferred_time}),u(!0)},U=s=>{confirm("Marquer ce rendez-vous comme terminé ?")&&o.post(route("admin.appointments.complete",s.id))},$=s=>{confirm("Êtes-vous sûr de vouloir supprimer définitivement ce rendez-vous ?")&&o.delete(route("admin.appointments.destroy",s.id))};return e.jsxs(e.Fragment,{children:[e.jsx(H,{title:"Tableau de bord - Administration"}),e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx("header",{className:"bg-white shadow-sm border-b mb-8",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Tableau de bord"}),e.jsx("p",{className:"text-gray-600 mt-2",children:"Vue d'ensemble et gestion des rendez-vous"})]})}),e.jsxs("main",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-6 mb-8",children:[e.jsxs("div",{className:"bg-white rounded-lg shadow p-6 text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-orange-500",children:c.pending}),e.jsx("div",{className:"text-sm text-gray-600 mt-2",children:"En attente"})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow p-6 text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-green-500",children:c.accepted}),e.jsx("div",{className:"text-sm text-gray-600 mt-2",children:"Acceptés"})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow p-6 text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-red-500",children:c.rejected}),e.jsx("div",{className:"text-sm text-gray-600 mt-2",children:"Refusés"})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow p-6 text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-gray-400",children:c.canceled}),e.jsx("div",{className:"text-sm text-gray-600 mt-2",children:"Annulés"})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow p-6 text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-blue-500",children:c.completed}),e.jsx("div",{className:"text-sm text-gray-600 mt-2",children:"Terminés"})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow p-6 text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-gray-500",children:c.expired}),e.jsx("div",{className:"text-sm text-gray-600 mt-2",children:"Expirés"})]})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow p-6 mb-8",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Statistiques sur 30 jours"}),e.jsx(O,{data:{title:"Évolution des rendez-vous sur 30 jours",series:[{name:"Rendez-vous",data:(z||[]).map(s=>({x:new Date(s.day).getTime(),y:s.count}))}]},type:"line"})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow p-6 mb-8",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Filtres des rendez-vous"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Statut"}),e.jsxs("select",{value:a.data.status,onChange:s=>a.setData("status",s.target.value),className:"w-full border-gray-300 rounded-md shadow-sm focus:border-blue-500 focus:ring-blue-500",children:[e.jsx("option",{value:"",children:"Tous les statuts"}),e.jsx("option",{value:"pending",children:"En attente"}),e.jsx("option",{value:"accepted",children:"Accepté"}),e.jsx("option",{value:"rejected",children:"Refusé"}),e.jsx("option",{value:"canceled",children:"Annulé"}),e.jsx("option",{value:"canceled_by_requester",children:"Annulé par le demandeur"}),e.jsx("option",{value:"expired",children:"Expiré"}),e.jsx("option",{value:"completed",children:"Terminé"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Priorité"}),e.jsxs("select",{value:a.data.priority,onChange:s=>a.setData("priority",s.target.value),className:"w-full border-gray-300 rounded-md shadow-sm focus:border-blue-500 focus:ring-blue-500",children:[e.jsx("option",{value:"",children:"Toutes les priorités"}),e.jsx("option",{value:"normal",children:"Normale"}),e.jsx("option",{value:"urgent",children:"Urgente"}),e.jsx("option",{value:"official",children:"Officielle"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Recherche"}),e.jsx("input",{type:"text",value:a.data.search,onChange:s=>a.setData("search",s.target.value),placeholder:"Nom, email ou objet...",className:"w-full border-gray-300 rounded-md shadow-sm focus:border-blue-500 focus:ring-blue-500"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Date de début"}),e.jsx("input",{type:"date",value:a.data.date_from,onChange:s=>a.setData("date_from",s.target.value),className:"w-full border-gray-300 rounded-md shadow-sm focus:border-blue-500 focus:ring-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Date de fin"}),e.jsx("input",{type:"date",value:a.data.date_to,onChange:s=>a.setData("date_to",s.target.value),className:"w-full border-gray-300 rounded-md shadow-sm focus:border-blue-500 focus:ring-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Tri"}),e.jsxs("select",{value:`${a.data.sort_by}-${a.data.sort_order}`,onChange:s=>{const[v,B]=s.target.value.split("-");a.setData("sort_by",v),a.setData("sort_order",B)},className:"w-full border-gray-300 rounded-md shadow-sm focus:border-blue-500 focus:ring-blue-500",children:[e.jsx("option",{value:"created_at-desc",children:"Plus récents"}),e.jsx("option",{value:"created_at-asc",children:"Plus anciens"}),e.jsx("option",{value:"preferred_date-asc",children:"Date RDV (croissant)"}),e.jsx("option",{value:"preferred_date-desc",children:"Date RDV (décroissant)"}),e.jsx("option",{value:"name-asc",children:"Nom (A-Z)"}),e.jsx("option",{value:"name-desc",children:"Nom (Z-A)"})]})]})]}),e.jsxs("div",{className:"flex space-x-3",children:[e.jsx(h,{onClick:A,children:"Filtrer"}),e.jsx(g,{onClick:M,children:"Réinitialiser"})]})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow p-6 mb-8",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Gestion des rendez-vous"}),e.jsx("div",{className:"text-sm text-gray-500",children:r&&r.total?`${r.total} rendez-vous trouvés`:"Aucun rendez-vous"})]}),r&&r.data&&r.data.length>0?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Demandeur"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Date & Heure"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Objet"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Priorité"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Statut"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:r.data.map(s=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium text-gray-900",children:s.name}),e.jsx("div",{className:"text-sm text-gray-500",children:s.email}),e.jsx("div",{className:"text-xs text-gray-400",children:s.phone})]})}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[e.jsx("div",{className:"text-sm text-gray-900",children:s.preferred_date}),e.jsx("div",{className:"text-sm text-gray-500",children:s.preferred_time})]}),e.jsxs("td",{className:"px-6 py-4",children:[e.jsx("div",{className:"text-sm text-gray-900 truncate max-w-xs",children:s.subject}),s.message&&e.jsxs("div",{className:"text-xs text-gray-500 truncate max-w-xs mt-1",children:[s.message.substring(0,50),"..."]})]}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${s.priority==="urgent"?"bg-red-100 text-red-800":s.priority==="official"?"bg-blue-100 text-blue-800":"bg-gray-100 text-gray-800"}`,children:s.formatted_priority})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx(k,{status:s.formatted_status,color:s.status==="pending"?"orange":s.status==="accepted"?"green":s.status==="rejected"?"red":s.status==="canceled"||s.status==="canceled_by_requester"?"gray":s.status==="completed"?"blue":"gray"})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:e.jsxs("div",{className:"flex flex-col space-y-1",children:[e.jsx(C,{href:route("admin.appointments.show",s.id),className:"text-blue-600 hover:text-blue-900 text-xs",children:"Voir détails"}),s.status==="pending"&&e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:()=>q(s),className:"text-green-600 hover:text-green-900 text-xs",children:"✓ Accepter"}),e.jsx("button",{onClick:()=>E(s),className:"text-red-600 hover:text-red-900 text-xs",children:"✗ Refuser"}),e.jsx("button",{onClick:()=>w(s),className:"text-gray-600 hover:text-gray-900 text-xs",children:"⊗ Annuler"})]}),s.status==="accepted"&&e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:()=>U(s),className:"text-blue-600 hover:text-blue-900 text-xs",children:"✓ Terminer"}),e.jsx("button",{onClick:()=>w(s),className:"text-gray-600 hover:text-gray-900 text-xs",children:"⊗ Annuler"})]}),e.jsx("button",{onClick:()=>P(s),className:"text-purple-600 hover:text-purple-900 text-xs",children:"✏️ Modifier"}),e.jsx("button",{onClick:()=>$(s),className:"text-red-600 hover:text-red-900 text-xs",children:"🗑️ Supprimer"})]})})]},s.id))})]})}),r.links&&r.links.length>3&&e.jsxs("div",{className:"mt-6 flex items-center justify-between",children:[e.jsxs("div",{className:"text-sm text-gray-700",children:["Affichage de ",r.from," à ",r.to," sur ",r.total," résultats"]}),e.jsx("div",{className:"flex space-x-2",children:r.links.map((s,v)=>e.jsx(C,{href:s.url,className:`px-3 py-2 text-sm rounded-md ${s.active?"bg-blue-500 text-white":s.url?"bg-white text-gray-700 border border-gray-300 hover:bg-gray-50":"bg-gray-100 text-gray-400 cursor-not-allowed"}`,dangerouslySetInnerHTML:{__html:s.label}},v))})]})]}):e.jsxs("div",{className:"text-gray-500 text-center py-8",children:[e.jsx("div",{className:"text-lg font-medium mb-2",children:"Aucun rendez-vous trouvé"}),e.jsx("div",{className:"text-sm",children:"Essayez de modifier vos filtres ou créez un nouveau rendez-vous."})]})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Prochains rendez-vous acceptés"}),j&&j.length>0?e.jsxs("table",{className:"min-w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{className:"text-left py-2",children:"Date"}),e.jsx("th",{className:"text-left py-2",children:"Heure"}),e.jsx("th",{className:"text-left py-2",children:"Demandeur"}),e.jsx("th",{className:"text-left py-2",children:"Objet"}),e.jsx("th",{className:"text-left py-2",children:"Statut"})]})}),e.jsx("tbody",{children:j.map(s=>e.jsxs("tr",{className:"border-b",children:[e.jsx("td",{className:"py-2",children:s.preferred_date}),e.jsx("td",{className:"py-2",children:s.preferred_time}),e.jsx("td",{className:"py-2",children:s.name}),e.jsx("td",{className:"py-2",children:s.subject}),e.jsx("td",{className:"py-2",children:e.jsx(k,{status:s.formatted_status,color:"green"})})]},s.id))})]}):e.jsx("div",{className:"text-gray-500 text-sm",children:"Aucun rendez-vous à venir."})]})]})]}),e.jsx(p,{show:D,onClose:()=>x(!1),maxWidth:"md",children:e.jsxs("div",{className:"p-6",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Refuser le rendez-vous"}),e.jsxs("p",{className:"text-sm text-gray-600 mb-4",children:["Veuillez indiquer la raison du refus pour le rendez-vous de ",l==null?void 0:l.name,"."]}),e.jsx("textarea",{value:b,onChange:s=>y(s.target.value),placeholder:"Raison du refus...",className:"w-full border-gray-300 rounded-md shadow-sm focus:border-blue-500 focus:ring-blue-500",rows:"4"}),e.jsxs("div",{className:"mt-6 flex justify-end space-x-3",children:[e.jsx(g,{onClick:()=>x(!1),children:"Annuler"}),e.jsx(h,{onClick:T,children:"Confirmer le refus"})]})]})}),e.jsx(p,{show:S,onClose:()=>m(!1),maxWidth:"md",children:e.jsxs("div",{className:"p-6",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Annuler le rendez-vous"}),e.jsxs("p",{className:"text-sm text-gray-600 mb-4",children:["Veuillez indiquer la raison de l'annulation pour le rendez-vous de ",l==null?void 0:l.name,"."]}),e.jsx("textarea",{value:f,onChange:s=>N(s.target.value),placeholder:"Raison de l'annulation...",className:"w-full border-gray-300 rounded-md shadow-sm focus:border-blue-500 focus:ring-blue-500",rows:"4"}),e.jsxs("div",{className:"mt-6 flex justify-end space-x-3",children:[e.jsx(g,{onClick:()=>m(!1),children:"Annuler"}),e.jsx(h,{onClick:F,children:"Confirmer l'annulation"})]})]})}),e.jsx(p,{show:R,onClose:()=>u(!1),maxWidth:"md",children:e.jsxs("div",{className:"p-6",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Modifier le rendez-vous"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Date préférée"}),e.jsx("input",{type:"date",value:d.data.preferred_date,onChange:s=>d.setData("preferred_date",s.target.value),className:"w-full border-gray-300 rounded-md shadow-sm focus:border-blue-500 focus:ring-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Heure préférée"}),e.jsx("input",{type:"time",value:d.data.preferred_time,onChange:s=>d.setData("preferred_time",s.target.value),className:"w-full border-gray-300 rounded-md shadow-sm focus:border-blue-500 focus:ring-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Notes d'administration"}),e.jsx("textarea",{value:d.data.admin_notes,onChange:s=>d.setData("admin_notes",s.target.value),placeholder:"Notes internes...",className:"w-full border-gray-300 rounded-md shadow-sm focus:border-blue-500 focus:ring-blue-500",rows:"3"})]})]}),e.jsxs("div",{className:"mt-6 flex justify-end space-x-3",children:[e.jsx(g,{onClick:()=>u(!1),children:"Annuler"}),e.jsx(h,{onClick:V,disabled:d.processing,children:d.processing?"Modification...":"Modifier"})]})]})})]})}export{K as default};
