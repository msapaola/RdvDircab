import{r as n,j as e,Q as j,S as g}from"./app-DUWSGQvp.js";import{S as i}from"./StatusBadge-70QWbfL9.js";import{P as N}from"./PrimaryButton-mGVfWMNZ.js";import{S as m}from"./dialog-DRVmSBcC.js";import{M as b}from"./Modal-D8j0qxzl.js";import"./transition-11aNuUMP.js";function _({appointment:s,activities:l}){const[o,t]=n.useState(!1),[d,c]=n.useState(!1),x=async()=>{c(!0);try{const r=await(await fetch(`/appointments/${s.secure_token}/cancel`,{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]').getAttribute("content")}})).json();r.success?g.reload():alert(r.message||"Une erreur est survenue")}catch{alert("Une erreur de connexion est survenue")}finally{c(!1),t(!1)}},h=a=>({pending:"orange",accepted:"green",rejected:"red",canceled:"gray",canceled_by_requester:"gray",expired:"gray",completed:"blue"})[a]||"gray",u=a=>({normal:"gray",urgent:"red",official:"blue"})[a]||"gray";return e.jsxs(e.Fragment,{children:[e.jsx(j,{title:`Suivi - ${s.subject}`}),e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx("header",{className:"bg-white shadow-sm border-b",children:e.jsx("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8",children:e.jsx("div",{className:"py-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Suivi de votre demande"}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Cabinet du Gouverneur de Kinshasa"})]}),e.jsx("a",{href:"/",className:"text-blue-600 hover:text-blue-800 text-sm font-medium",children:"← Retour à l'accueil"})]})})})}),e.jsxs("main",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[e.jsx("div",{className:"bg-white rounded-lg shadow-sm border mb-6",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Statut de votre demande"}),e.jsx(i,{status:s.formatted_status,color:h(s.status)})]}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-gray-500 mb-2",children:"Détails de la demande"}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Objet :"})," ",s.subject]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Date souhaitée :"})," ",s.preferred_date]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Heure souhaitée :"})," ",s.preferred_time]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Priorité :"}),e.jsx(i,{status:s.formatted_priority,color:u(s.priority),size:"sm"})]})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-gray-500 mb-2",children:"Vos informations"}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Nom :"})," ",s.name]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Email :"})," ",s.email]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Téléphone :"})," ",s.phone]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Date de soumission :"})," ",s.created_at]})]})]})]}),s.message&&e.jsxs("div",{className:"mt-6",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-500 mb-2",children:"Message"}),e.jsx("div",{className:"bg-gray-50 rounded-lg p-4 text-sm text-gray-700",children:s.message})]}),s.attachments&&s.attachments.length>0&&e.jsxs("div",{className:"mt-6",children:[e.jsxs("h3",{className:"text-sm font-medium text-gray-500 mb-2",children:["Pièces jointes (",s.attachments.length,")"]}),e.jsx("div",{className:"space-y-2",children:s.attachments.map((a,r)=>e.jsxs("div",{className:"flex items-center text-sm text-gray-600",children:[e.jsx("svg",{className:"w-4 h-4 mr-2",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M4 4a2 2 0 012-2h4.586A2 2 0 0112 2.586L15.414 6A2 2 0 0116 7.414V16a2 2 0 01-2 2H6a2 2 0 01-2-2V4zm2 6a1 1 0 011-1h6a1 1 0 110 2H7a1 1 0 01-1-1zm1 3a1 1 0 100 2h6a1 1 0 100-2H7z",clipRule:"evenodd"})}),a.name]},r))})]}),s.can_be_canceled_by_requester&&e.jsx("div",{className:"mt-6 pt-6 border-t border-gray-200",children:e.jsx(m,{onClick:()=>t(!0),className:"text-red-600 border-red-300 hover:bg-red-50",children:"Annuler ce rendez-vous"})}),s.admin_notes&&e.jsxs("div",{className:"mt-6 p-4 bg-blue-50 border border-blue-200 rounded-lg",children:[e.jsx("h3",{className:"text-sm font-medium text-blue-900 mb-2",children:"Note de l'administration"}),e.jsx("p",{className:"text-sm text-blue-800",children:s.admin_notes})]}),s.rejection_reason&&e.jsxs("div",{className:"mt-6 p-4 bg-red-50 border border-red-200 rounded-lg",children:[e.jsx("h3",{className:"text-sm font-medium text-red-900 mb-2",children:"Raison du refus"}),e.jsx("p",{className:"text-sm text-red-800",children:s.rejection_reason})]})]})}),e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border",children:[e.jsx("div",{className:"p-6 border-b",children:e.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Historique des actions"})}),e.jsx("div",{className:"p-6",children:l.length>0?e.jsx("div",{className:"space-y-4",children:l.map((a,r)=>e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full mt-2"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm text-gray-900",children:a.formatted_description}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:a.time_ago})]})]},r))}):e.jsx("div",{className:"text-center py-8",children:e.jsx("p",{className:"text-gray-500 text-sm",children:"Aucune activité enregistrée pour le moment."})})})]}),e.jsxs("div",{className:"mt-6 bg-blue-50 border border-blue-200 rounded-lg p-4",children:[e.jsx("h3",{className:"text-sm font-medium text-blue-900 mb-2",children:"Informations importantes"}),e.jsxs("ul",{className:"text-sm text-blue-800 space-y-1",children:[e.jsx("li",{children:"• Vous recevrez une notification par email lors de tout changement de statut"}),e.jsx("li",{children:"• Les rendez-vous acceptés peuvent être annulés jusqu'à 24h avant la date"}),e.jsx("li",{children:"• En cas d'urgence, contactez-nous directement au +243 XXX XXX XXX"})]})]})]})]}),e.jsx(b,{show:o,onClose:()=>t(!1),maxWidth:"md",children:e.jsxs("div",{className:"p-6",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Confirmer l'annulation"}),e.jsx("p",{className:"text-sm text-gray-600 mb-6",children:"Êtes-vous sûr de vouloir annuler votre rendez-vous ? Cette action ne peut pas être annulée."}),e.jsxs("div",{className:"flex justify-end space-x-3",children:[e.jsx(m,{onClick:()=>t(!1),children:"Annuler"}),e.jsx(N,{onClick:x,disabled:d,className:"bg-red-600 hover:bg-red-700 focus:ring-red-500",children:d?"Annulation...":"Confirmer l'annulation"})]})]})})]})}export{_ as default};
