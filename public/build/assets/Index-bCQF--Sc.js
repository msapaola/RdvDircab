import{r as c,x as M,j as e,Q as q,t as j,S as x}from"./app-DCiTD91t.js";import{S as v}from"./StatusBadge-Dghtsy4_.js";import{P as g}from"./PrimaryButton-Cflf1NvB.js";import{S as b}from"./dialog-D0xC2e0j.js";import{M as y}from"./Modal-k590P5z0.js";import{D as T}from"./DashboardMenu-Dgg3hCmk.js";import"./transition-DRQUBbh3.js";import"./ApplicationLogo-D2QVaGxh.js";import"./ResponsiveNavLink-DCw2hBrJ.js";function I({appointments:r,stats:d,filters:l}){const[N,i]=c.useState(!1),[w,n]=c.useState(!1),[a,o]=c.useState(null),[u,f]=c.useState(""),[m,p]=c.useState(""),t=M({status:l.status||"",priority:l.priority||"",date_from:l.date_from||"",date_to:l.date_to||"",search:l.search||"",sort_by:l.sort_by||"created_at",sort_order:l.sort_order||"desc"}),_=()=>{t.get(route("admin.appointments.index"))},C=()=>{t.reset(),x.get(route("admin.appointments.index"))},R=()=>{if(!u.trim()){alert("Veuillez indiquer une raison de refus.");return}x.post(route("admin.appointments.reject",a.id),{rejection_reason:u}),i(!1),o(null),f("")},k=()=>{if(!m.trim()){alert("Veuillez indiquer une raison d'annulation.");return}x.post(route("admin.appointments.cancel",a.id),{admin_notes:m}),n(!1),o(null),p("")},D=s=>{confirm("Êtes-vous sûr de vouloir accepter ce rendez-vous ?")&&x.post(route("admin.appointments.accept",s.id))},S=s=>{o(s),i(!0)},A=s=>{o(s),n(!0)};return e.jsxs(e.Fragment,{children:[e.jsx(q,{title:"Gestion des rendez-vous - Administration"}),e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx(T,{}),e.jsx("header",{className:"bg-white shadow-sm border-b mb-8",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Gestion des rendez-vous"}),e.jsx("p",{className:"text-gray-600 mt-2",children:"Liste et gestion de tous les rendez-vous"})]}),e.jsx(j,{href:route("admin.dashboard"),className:"text-blue-600 hover:text-blue-800 text-sm font-medium",children:"← Retour au tableau de bord"})]})})}),e.jsxs("main",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-6 gap-4 mb-8",children:[e.jsxs("div",{className:"bg-white rounded-lg shadow p-4 text-center",children:[e.jsx("div",{className:"text-xl font-bold text-gray-900",children:d.total}),e.jsx("div",{className:"text-sm text-gray-600",children:"Total"})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow p-4 text-center",children:[e.jsx("div",{className:"text-xl font-bold text-orange-500",children:d.pending}),e.jsx("div",{className:"text-sm text-gray-600",children:"En attente"})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow p-4 text-center",children:[e.jsx("div",{className:"text-xl font-bold text-green-500",children:d.accepted}),e.jsx("div",{className:"text-sm text-gray-600",children:"Acceptés"})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow p-4 text-center",children:[e.jsx("div",{className:"text-xl font-bold text-red-500",children:d.rejected}),e.jsx("div",{className:"text-sm text-gray-600",children:"Refusés"})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow p-4 text-center",children:[e.jsx("div",{className:"text-xl font-bold text-gray-400",children:d.canceled}),e.jsx("div",{className:"text-sm text-gray-600",children:"Annulés"})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow p-4 text-center",children:[e.jsx("div",{className:"text-xl font-bold text-blue-500",children:d.completed}),e.jsx("div",{className:"text-sm text-gray-600",children:"Terminés"})]})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow p-6 mb-8",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Filtres"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Statut"}),e.jsxs("select",{value:t.data.status,onChange:s=>t.setData("status",s.target.value),className:"w-full border-gray-300 rounded-md shadow-sm focus:border-blue-500 focus:ring-blue-500",children:[e.jsx("option",{value:"",children:"Tous les statuts"}),e.jsx("option",{value:"pending",children:"En attente"}),e.jsx("option",{value:"accepted",children:"Accepté"}),e.jsx("option",{value:"rejected",children:"Refusé"}),e.jsx("option",{value:"canceled",children:"Annulé"}),e.jsx("option",{value:"canceled_by_requester",children:"Annulé par le demandeur"}),e.jsx("option",{value:"expired",children:"Expiré"}),e.jsx("option",{value:"completed",children:"Terminé"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Priorité"}),e.jsxs("select",{value:t.data.priority,onChange:s=>t.setData("priority",s.target.value),className:"w-full border-gray-300 rounded-md shadow-sm focus:border-blue-500 focus:ring-blue-500",children:[e.jsx("option",{value:"",children:"Toutes les priorités"}),e.jsx("option",{value:"normal",children:"Normale"}),e.jsx("option",{value:"urgent",children:"Urgente"}),e.jsx("option",{value:"official",children:"Officielle"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Recherche"}),e.jsx("input",{type:"text",value:t.data.search,onChange:s=>t.setData("search",s.target.value),placeholder:"Nom, email ou objet...",className:"w-full border-gray-300 rounded-md shadow-sm focus:border-blue-500 focus:ring-blue-500"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Date de début"}),e.jsx("input",{type:"date",value:t.data.date_from,onChange:s=>t.setData("date_from",s.target.value),className:"w-full border-gray-300 rounded-md shadow-sm focus:border-blue-500 focus:ring-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Date de fin"}),e.jsx("input",{type:"date",value:t.data.date_to,onChange:s=>t.setData("date_to",s.target.value),className:"w-full border-gray-300 rounded-md shadow-sm focus:border-blue-500 focus:ring-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Tri"}),e.jsxs("select",{value:`${t.data.sort_by}-${t.data.sort_order}`,onChange:s=>{const[h,z]=s.target.value.split("-");t.setData("sort_by",h),t.setData("sort_order",z)},className:"w-full border-gray-300 rounded-md shadow-sm focus:border-blue-500 focus:ring-blue-500",children:[e.jsx("option",{value:"created_at-desc",children:"Plus récents"}),e.jsx("option",{value:"created_at-asc",children:"Plus anciens"}),e.jsx("option",{value:"preferred_date-asc",children:"Date RDV (croissant)"}),e.jsx("option",{value:"preferred_date-desc",children:"Date RDV (décroissant)"}),e.jsx("option",{value:"name-asc",children:"Nom (A-Z)"}),e.jsx("option",{value:"name-desc",children:"Nom (Z-A)"})]})]})]}),e.jsxs("div",{className:"flex space-x-3",children:[e.jsx(g,{onClick:_,children:"Appliquer les filtres"}),e.jsx(b,{onClick:C,children:"Réinitialiser"})]})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:[e.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:e.jsxs("h2",{className:"text-lg font-semibold text-gray-900",children:["Rendez-vous (",r.total,")"]})}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Demandeur"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Objet"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Date/Heure"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Priorité"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Statut"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:r.data.map(s=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium text-gray-900",children:s.name}),e.jsx("div",{className:"text-sm text-gray-500",children:s.email})]})}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("div",{className:"text-sm text-gray-900 max-w-xs truncate",children:s.subject})}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[e.jsx("div",{className:"text-sm text-gray-900",children:s.preferred_date}),e.jsx("div",{className:"text-sm text-gray-500",children:s.preferred_time})]}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx(v,{status:s.formatted_priority,color:s.priority==="urgent"?"red":s.priority==="official"?"blue":"gray"})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx(v,{status:s.formatted_status,color:s.status==="pending"?"orange":s.status==="accepted"?"green":s.status==="rejected"?"red":s.status==="canceled"||s.status==="canceled_by_requester"?"gray":s.status==="completed"?"blue":"gray"})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(j,{href:route("admin.appointments.show",s.id),className:"text-blue-600 hover:text-blue-900",children:"Voir"}),s.status==="pending"&&e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:()=>D(s),className:"text-green-600 hover:text-green-900",children:"Accepter"}),e.jsx("button",{onClick:()=>S(s),className:"text-red-600 hover:text-red-900",children:"Refuser"}),e.jsx("button",{onClick:()=>A(s),className:"text-gray-600 hover:text-gray-900",children:"Annuler"})]})]})})]},s.id))})]})}),r.links&&e.jsx("div",{className:"px-6 py-3 border-t border-gray-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"text-sm text-gray-700",children:["Affichage de ",r.from," à ",r.to," sur ",r.total," résultats"]}),e.jsx("div",{className:"flex space-x-2",children:r.links.map((s,h)=>e.jsx(j,{href:s.url,className:`px-3 py-2 text-sm rounded-md ${s.active?"bg-blue-500 text-white":"bg-white text-gray-700 hover:bg-gray-50"} ${s.url?"":"opacity-50 cursor-not-allowed"}`,dangerouslySetInnerHTML:{__html:s.label}},h))})]})})]})]})]}),e.jsx(y,{show:N,onClose:()=>i(!1),maxWidth:"md",children:e.jsxs("div",{className:"p-6",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Refuser le rendez-vous"}),e.jsxs("p",{className:"text-sm text-gray-600 mb-4",children:["Veuillez indiquer la raison du refus pour le rendez-vous de ",a==null?void 0:a.name,"."]}),e.jsx("textarea",{value:u,onChange:s=>f(s.target.value),placeholder:"Raison du refus...",className:"w-full border-gray-300 rounded-md shadow-sm focus:border-blue-500 focus:ring-blue-500",rows:"4"}),e.jsxs("div",{className:"mt-6 flex justify-end space-x-3",children:[e.jsx(b,{onClick:()=>i(!1),children:"Annuler"}),e.jsx(g,{onClick:R,children:"Confirmer le refus"})]})]})}),e.jsx(y,{show:w,onClose:()=>n(!1),maxWidth:"md",children:e.jsxs("div",{className:"p-6",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Annuler le rendez-vous"}),e.jsxs("p",{className:"text-sm text-gray-600 mb-4",children:["Veuillez indiquer la raison de l'annulation pour le rendez-vous de ",a==null?void 0:a.name,"."]}),e.jsx("textarea",{value:m,onChange:s=>p(s.target.value),placeholder:"Raison de l'annulation...",className:"w-full border-gray-300 rounded-md shadow-sm focus:border-blue-500 focus:ring-blue-500",rows:"4"}),e.jsxs("div",{className:"mt-6 flex justify-end space-x-3",children:[e.jsx(b,{onClick:()=>n(!1),children:"Annuler"}),e.jsx(g,{onClick:k,children:"Confirmer l'annulation"})]})]})})]})}export{I as default};
