import{r as t,x as R,j as e,Q as z,t as M,S as h}from"./app-D3uSDngM.js";import{S as b}from"./StatusBadge-BAC-UM7d.js";import{P as n}from"./PrimaryButton-BEZJ0DU6.js";import{S as l}from"./dialog-DXf3JeXc.js";import{M as u}from"./Modal-DIwXSRGx.js";import{A}from"./AttachmentViewer-CpiSz_6o.js";import"./transition-9XgLK-51.js";function H({appointment:s,activities:j}){const[N,d]=t.useState(!1),[y,c]=t.useState(!1),[v,i]=t.useState(!1),[o,g]=t.useState(""),[x,f]=t.useState(""),a=R({admin_notes:s.admin_notes||"",preferred_date:s.preferred_date,preferred_time:s.preferred_time}),p=()=>{confirm("Êtes-vous sûr de vouloir accepter ce rendez-vous ?")&&h.post(route("admin.appointments.accept",s.id))},w=()=>{if(!o.trim()){alert("Veuillez indiquer une raison de refus.");return}h.post(route("admin.appointments.reject",s.id),{rejection_reason:o}),d(!1),g("")},_=()=>{if(!x.trim()){alert("Veuillez indiquer une raison d'annulation.");return}h.post(route("admin.appointments.cancel",s.id),{admin_notes:x}),c(!1),f("")},C=()=>{a.put(route("admin.appointments.update",s.id),{onSuccess:()=>{i(!1)}})},S=r=>({pending:"orange",accepted:"green",rejected:"red",canceled:"gray",canceled_by_requester:"gray",expired:"gray",completed:"blue"})[r]||"gray",k=r=>({normal:"gray",urgent:"red",official:"blue"})[r]||"gray";return e.jsxs(e.Fragment,{children:[e.jsx(z,{title:`Rendez-vous - ${s.subject}`}),e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx("header",{className:"bg-white shadow-sm border-b mb-8",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Détail du rendez-vous"}),e.jsx("p",{className:"text-gray-600 mt-2",children:s.subject})]}),e.jsx(M,{href:route("admin.appointments.index"),className:"text-blue-600 hover:text-blue-800 text-sm font-medium",children:"← Retour à la liste"})]})})}),e.jsx("main",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[e.jsxs("div",{className:"lg:col-span-2",children:[e.jsxs("div",{className:"bg-white rounded-lg shadow p-6 mb-6",children:[e.jsxs("div",{className:"flex justify-between items-start mb-6",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Informations du rendez-vous"}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(b,{status:s.formatted_status,color:S(s.status)}),e.jsx(b,{status:s.formatted_priority,color:k(s.priority)})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-gray-500 mb-2",children:"Demandeur"}),e.jsxs("div",{className:"space-y-1",children:[e.jsxs("p",{className:"text-sm text-gray-900",children:[e.jsx("strong",{children:"Nom :"})," ",s.name]}),e.jsxs("p",{className:"text-sm text-gray-900",children:[e.jsx("strong",{children:"Email :"})," ",s.email]}),e.jsxs("p",{className:"text-sm text-gray-900",children:[e.jsx("strong",{children:"Téléphone :"})," ",s.phone]})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-gray-500 mb-2",children:"Détails"}),e.jsxs("div",{className:"space-y-1",children:[e.jsxs("p",{className:"text-sm text-gray-900",children:[e.jsx("strong",{children:"Date souhaitée :"})," ",s.preferred_date]}),e.jsxs("p",{className:"text-sm text-gray-900",children:[e.jsx("strong",{children:"Heure souhaitée :"})," ",s.preferred_time]}),e.jsxs("p",{className:"text-sm text-gray-900",children:[e.jsx("strong",{children:"Date de soumission :"})," ",s.created_at]}),s.processed_by&&e.jsxs("p",{className:"text-sm text-gray-900",children:[e.jsx("strong",{children:"Traité par :"})," ",s.processed_by.name]})]})]})]}),e.jsxs("div",{className:"mt-6",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-500 mb-2",children:"Objet"}),e.jsx("p",{className:"text-sm text-gray-900",children:s.subject})]}),s.message&&e.jsxs("div",{className:"mt-6",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-500 mb-2",children:"Message"}),e.jsx("div",{className:"bg-gray-50 rounded-lg p-4",children:e.jsx("p",{className:"text-sm text-gray-700",children:s.message})})]}),e.jsx(A,{attachments:s.attachments,appointmentId:s.id}),s.status==="pending"&&e.jsxs("div",{className:"mt-6 pt-6 border-t border-gray-200",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-900 mb-4",children:"Actions"}),e.jsxs("div",{className:"flex space-x-3",children:[e.jsx(n,{onClick:p,children:"Accepter"}),e.jsx(l,{onClick:()=>d(!0),children:"Refuser"}),e.jsx(l,{onClick:()=>c(!0),children:"Annuler"}),e.jsx(l,{onClick:()=>i(!0),children:"Modifier"})]})]})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-4",children:"Historique des actions"}),j.length>0?e.jsx("div",{className:"space-y-4",children:j.map((r,m)=>e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full mt-2"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm text-gray-900",children:r.formatted_description}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:r.time_ago})]})]},m))}):e.jsx("div",{className:"text-center py-8",children:e.jsx("p",{className:"text-gray-500 text-sm",children:"Aucune activité enregistrée pour le moment."})})]})]}),e.jsxs("div",{className:"lg:col-span-1",children:[e.jsxs("div",{className:"bg-white rounded-lg shadow p-6 mb-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Notes administratives"}),s.admin_notes?e.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:e.jsx("p",{className:"text-sm text-blue-800",children:s.admin_notes})}):e.jsx("p",{className:"text-sm text-gray-500",children:"Aucune note administrative."})]}),s.rejection_reason&&e.jsxs("div",{className:"bg-white rounded-lg shadow p-6 mb-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Raison du refus"}),e.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:e.jsx("p",{className:"text-sm text-red-800",children:s.rejection_reason})})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Informations système"}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"ID :"})," ",s.id]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Token :"})," ",e.jsx("code",{className:"text-xs bg-gray-100 px-1 rounded",children:s.secure_token})]}),e.jsxs("p",{children:[e.jsx("strong",{children:"IP :"})," ",s.ip_address]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Créé le :"})," ",s.created_at]}),s.updated_at!==s.created_at&&e.jsxs("p",{children:[e.jsx("strong",{children:"Modifié le :"})," ",s.updated_at]})]})]})]})]})})]}),e.jsx(u,{show:N,onClose:()=>d(!1),maxWidth:"md",children:e.jsxs("div",{className:"p-6",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Refuser le rendez-vous"}),e.jsxs("p",{className:"text-sm text-gray-600 mb-4",children:["Veuillez indiquer la raison du refus pour le rendez-vous de ",s.name,"."]}),e.jsx("textarea",{value:o,onChange:r=>g(r.target.value),placeholder:"Raison du refus...",className:"w-full border-gray-300 rounded-md shadow-sm focus:border-blue-500 focus:ring-blue-500",rows:"4"}),e.jsxs("div",{className:"mt-6 flex justify-end space-x-3",children:[e.jsx(l,{onClick:()=>d(!1),children:"Annuler"}),e.jsx(n,{onClick:w,children:"Confirmer le refus"})]})]})}),e.jsx(u,{show:y,onClose:()=>c(!1),maxWidth:"md",children:e.jsxs("div",{className:"p-6",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Annuler le rendez-vous"}),e.jsxs("p",{className:"text-sm text-gray-600 mb-4",children:["Veuillez indiquer la raison de l'annulation pour le rendez-vous de ",s.name,"."]}),e.jsx("textarea",{value:x,onChange:r=>f(r.target.value),placeholder:"Raison de l'annulation...",className:"w-full border-gray-300 rounded-md shadow-sm focus:border-blue-500 focus:ring-blue-500",rows:"4"}),e.jsxs("div",{className:"mt-6 flex justify-end space-x-3",children:[e.jsx(l,{onClick:()=>c(!1),children:"Annuler"}),e.jsx(n,{onClick:_,children:"Confirmer l'annulation"})]})]})}),e.jsx(u,{show:v,onClose:()=>i(!1),maxWidth:"md",children:e.jsxs("div",{className:"p-6",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Modifier le rendez-vous"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Date souhaitée"}),e.jsx("input",{type:"date",value:a.data.preferred_date,onChange:r=>a.setData("preferred_date",r.target.value),className:"w-full border-gray-300 rounded-md shadow-sm focus:border-blue-500 focus:ring-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Heure souhaitée"}),e.jsx("input",{type:"time",value:a.data.preferred_time,onChange:r=>a.setData("preferred_time",r.target.value),className:"w-full border-gray-300 rounded-md shadow-sm focus:border-blue-500 focus:ring-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Notes administratives"}),e.jsx("textarea",{value:a.data.admin_notes,onChange:r=>a.setData("admin_notes",r.target.value),placeholder:"Notes administratives...",className:"w-full border-gray-300 rounded-md shadow-sm focus:border-blue-500 focus:ring-blue-500",rows:"4"})]})]}),e.jsxs("div",{className:"mt-6 flex justify-end space-x-3",children:[e.jsx(l,{onClick:()=>i(!1),children:"Annuler"}),e.jsx(n,{onClick:C,disabled:a.processing,children:a.processing?"Modification...":"Enregistrer"})]})]})})]})}export{H as default};
