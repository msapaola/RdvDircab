import{r as d,x as S,j as e,Q as k,t as M,S as h}from"./app-DNsZWY2n.js";import{S as b}from"./StatusBadge-DVA83DhV.js";import{P as o}from"./PrimaryButton-Bzfb51SC.js";import{S as l}from"./dialog-adFZNHdt.js";import{M as u}from"./Modal-C99oRZyp.js";import"./transition-CCa0VhyM.js";function P({appointment:s,activities:j}){const[N,c]=d.useState(!1),[y,i]=d.useState(!1),[v,n]=d.useState(!1),[x,g]=d.useState(""),[m,f]=d.useState(""),r=S({admin_notes:s.admin_notes||"",preferred_date:s.preferred_date,preferred_time:s.preferred_time}),p=()=>{confirm("Êtes-vous sûr de vouloir accepter ce rendez-vous ?")&&h.post(route("admin.appointments.accept",s.id))},w=()=>{if(!x.trim()){alert("Veuillez indiquer une raison de refus.");return}h.post(route("admin.appointments.reject",s.id),{rejection_reason:x}),c(!1),g("")},_=()=>{if(!m.trim()){alert("Veuillez indiquer une raison d'annulation.");return}h.post(route("admin.appointments.cancel",s.id),{admin_notes:m}),i(!1),f("")},C=()=>{r.put(route("admin.appointments.update",s.id),{onSuccess:()=>{n(!1)}})},R=a=>({pending:"orange",accepted:"green",rejected:"red",canceled:"gray",canceled_by_requester:"gray",expired:"gray",completed:"blue"})[a]||"gray",z=a=>({normal:"gray",urgent:"red",official:"blue"})[a]||"gray";return e.jsxs(e.Fragment,{children:[e.jsx(k,{title:`Rendez-vous - ${s.subject}`}),e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx("header",{className:"bg-white shadow-sm border-b mb-8",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Détail du rendez-vous"}),e.jsx("p",{className:"text-gray-600 mt-2",children:s.subject})]}),e.jsx(M,{href:route("admin.appointments.index"),className:"text-blue-600 hover:text-blue-800 text-sm font-medium",children:"← Retour à la liste"})]})})}),e.jsx("main",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[e.jsxs("div",{className:"lg:col-span-2",children:[e.jsxs("div",{className:"bg-white rounded-lg shadow p-6 mb-6",children:[e.jsxs("div",{className:"flex justify-between items-start mb-6",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Informations du rendez-vous"}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(b,{status:s.formatted_status,color:R(s.status)}),e.jsx(b,{status:s.formatted_priority,color:z(s.priority)})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-gray-500 mb-2",children:"Demandeur"}),e.jsxs("div",{className:"space-y-1",children:[e.jsxs("p",{className:"text-sm text-gray-900",children:[e.jsx("strong",{children:"Nom :"})," ",s.name]}),e.jsxs("p",{className:"text-sm text-gray-900",children:[e.jsx("strong",{children:"Email :"})," ",s.email]}),e.jsxs("p",{className:"text-sm text-gray-900",children:[e.jsx("strong",{children:"Téléphone :"})," ",s.phone]})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-gray-500 mb-2",children:"Détails"}),e.jsxs("div",{className:"space-y-1",children:[e.jsxs("p",{className:"text-sm text-gray-900",children:[e.jsx("strong",{children:"Date souhaitée :"})," ",s.preferred_date]}),e.jsxs("p",{className:"text-sm text-gray-900",children:[e.jsx("strong",{children:"Heure souhaitée :"})," ",s.preferred_time]}),e.jsxs("p",{className:"text-sm text-gray-900",children:[e.jsx("strong",{children:"Date de soumission :"})," ",s.created_at]}),s.processed_by&&e.jsxs("p",{className:"text-sm text-gray-900",children:[e.jsx("strong",{children:"Traité par :"})," ",s.processed_by.name]})]})]})]}),e.jsxs("div",{className:"mt-6",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-500 mb-2",children:"Objet"}),e.jsx("p",{className:"text-sm text-gray-900",children:s.subject})]}),s.message&&e.jsxs("div",{className:"mt-6",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-500 mb-2",children:"Message"}),e.jsx("div",{className:"bg-gray-50 rounded-lg p-4",children:e.jsx("p",{className:"text-sm text-gray-700",children:s.message})})]}),s.attachments&&s.attachments.length>0&&e.jsxs("div",{className:"mt-6",children:[e.jsxs("h3",{className:"text-sm font-medium text-gray-500 mb-2",children:["Pièces jointes (",s.attachments.length,")"]}),e.jsx("div",{className:"space-y-2",children:s.attachments.map((a,t)=>e.jsxs("div",{className:"flex items-center justify-between bg-gray-50 p-3 rounded-lg",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("svg",{className:"w-4 h-4 text-gray-400 mr-2",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M4 4a2 2 0 012-2h4.586A2 2 0 0112 2.586L15.414 6A2 2 0 0116 7.414V16a2 2 0 01-2 2H6a2 2 0 01-2-2V4zm2 6a1 1 0 011-1h6a1 1 0 110 2H7a1 1 0 01-1-1zm1 3a1 1 0 100 2h6a1 1 0 100-2H7z",clipRule:"evenodd"})}),e.jsx("span",{className:"text-sm text-gray-700",children:a.name})]}),e.jsxs("span",{className:"text-xs text-gray-500",children:[(a.size/1024/1024).toFixed(2)," MB"]})]},t))})]}),s.status==="pending"&&e.jsxs("div",{className:"mt-6 pt-6 border-t border-gray-200",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-900 mb-4",children:"Actions"}),e.jsxs("div",{className:"flex space-x-3",children:[e.jsx(o,{onClick:p,children:"Accepter"}),e.jsx(l,{onClick:()=>c(!0),children:"Refuser"}),e.jsx(l,{onClick:()=>i(!0),children:"Annuler"}),e.jsx(l,{onClick:()=>n(!0),children:"Modifier"})]})]})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-4",children:"Historique des actions"}),j.length>0?e.jsx("div",{className:"space-y-4",children:j.map((a,t)=>e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full mt-2"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm text-gray-900",children:a.formatted_description}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:a.time_ago})]})]},t))}):e.jsx("div",{className:"text-center py-8",children:e.jsx("p",{className:"text-gray-500 text-sm",children:"Aucune activité enregistrée pour le moment."})})]})]}),e.jsxs("div",{className:"lg:col-span-1",children:[e.jsxs("div",{className:"bg-white rounded-lg shadow p-6 mb-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Notes administratives"}),s.admin_notes?e.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:e.jsx("p",{className:"text-sm text-blue-800",children:s.admin_notes})}):e.jsx("p",{className:"text-sm text-gray-500",children:"Aucune note administrative."})]}),s.rejection_reason&&e.jsxs("div",{className:"bg-white rounded-lg shadow p-6 mb-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Raison du refus"}),e.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:e.jsx("p",{className:"text-sm text-red-800",children:s.rejection_reason})})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Informations système"}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"ID :"})," ",s.id]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Token :"})," ",e.jsx("code",{className:"text-xs bg-gray-100 px-1 rounded",children:s.secure_token})]}),e.jsxs("p",{children:[e.jsx("strong",{children:"IP :"})," ",s.ip_address]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Créé le :"})," ",s.created_at]}),s.updated_at!==s.created_at&&e.jsxs("p",{children:[e.jsx("strong",{children:"Modifié le :"})," ",s.updated_at]})]})]})]})]})})]}),e.jsx(u,{show:N,onClose:()=>c(!1),maxWidth:"md",children:e.jsxs("div",{className:"p-6",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Refuser le rendez-vous"}),e.jsxs("p",{className:"text-sm text-gray-600 mb-4",children:["Veuillez indiquer la raison du refus pour le rendez-vous de ",s.name,"."]}),e.jsx("textarea",{value:x,onChange:a=>g(a.target.value),placeholder:"Raison du refus...",className:"w-full border-gray-300 rounded-md shadow-sm focus:border-blue-500 focus:ring-blue-500",rows:"4"}),e.jsxs("div",{className:"mt-6 flex justify-end space-x-3",children:[e.jsx(l,{onClick:()=>c(!1),children:"Annuler"}),e.jsx(o,{onClick:w,children:"Confirmer le refus"})]})]})}),e.jsx(u,{show:y,onClose:()=>i(!1),maxWidth:"md",children:e.jsxs("div",{className:"p-6",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Annuler le rendez-vous"}),e.jsxs("p",{className:"text-sm text-gray-600 mb-4",children:["Veuillez indiquer la raison de l'annulation pour le rendez-vous de ",s.name,"."]}),e.jsx("textarea",{value:m,onChange:a=>f(a.target.value),placeholder:"Raison de l'annulation...",className:"w-full border-gray-300 rounded-md shadow-sm focus:border-blue-500 focus:ring-blue-500",rows:"4"}),e.jsxs("div",{className:"mt-6 flex justify-end space-x-3",children:[e.jsx(l,{onClick:()=>i(!1),children:"Annuler"}),e.jsx(o,{onClick:_,children:"Confirmer l'annulation"})]})]})}),e.jsx(u,{show:v,onClose:()=>n(!1),maxWidth:"md",children:e.jsxs("div",{className:"p-6",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Modifier le rendez-vous"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Date souhaitée"}),e.jsx("input",{type:"date",value:r.data.preferred_date,onChange:a=>r.setData("preferred_date",a.target.value),className:"w-full border-gray-300 rounded-md shadow-sm focus:border-blue-500 focus:ring-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Heure souhaitée"}),e.jsx("input",{type:"time",value:r.data.preferred_time,onChange:a=>r.setData("preferred_time",a.target.value),className:"w-full border-gray-300 rounded-md shadow-sm focus:border-blue-500 focus:ring-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Notes administratives"}),e.jsx("textarea",{value:r.data.admin_notes,onChange:a=>r.setData("admin_notes",a.target.value),placeholder:"Notes administratives...",className:"w-full border-gray-300 rounded-md shadow-sm focus:border-blue-500 focus:ring-blue-500",rows:"4"})]})]}),e.jsxs("div",{className:"mt-6 flex justify-end space-x-3",children:[e.jsx(l,{onClick:()=>n(!1),children:"Annuler"}),e.jsx(o,{onClick:C,disabled:r.processing,children:r.processing?"Modification...":"Enregistrer"})]})]})})]})}export{P as default};
