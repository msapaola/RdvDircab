import{r as n,x as _,j as e,Q as $,t as C,S as x}from"./app-Cf9fbO_m.js";import{A as H}from"./AdminLayout-BV8YOq4W.js";import{S as L}from"./Statistics-BGbF2RqD.js";import{S as V}from"./StatusBadge-vBNFIknI.js";import{P as o}from"./PrimaryButton-DDFkTA6b.js";import{S as l}from"./SecondaryButton-C7OcH8if.js";import{M as v}from"./Modal-B6UVUFNb.js";import"./ApplicationLogo-Csogalo6.js";import"./ResponsiveNavLink-l3F2Jj7i.js";import"./transition-CRqTjt7I.js";function se({auth:p,stats:c,nextAppointments:j,statsByDay:k,appointments:r,filters:t}){const[S,m]=n.useState(!1),[R,u]=n.useState(!1),[A,h]=n.useState(!1),[g,i]=n.useState(null),[b,N]=n.useState(""),[f,w]=n.useState(""),a=_({status:(t==null?void 0:t.status)||"",priority:(t==null?void 0:t.priority)||"",date_from:(t==null?void 0:t.date_from)||"",date_to:(t==null?void 0:t.date_to)||"",search:(t==null?void 0:t.search)||"",sort_by:(t==null?void 0:t.sort_by)||"created_at",sort_order:(t==null?void 0:t.sort_order)||"desc"}),d=_({admin_notes:"",preferred_date:"",preferred_time:""}),D=()=>{a.get(route("admin.dashboard"))},M=()=>{a.reset(),x.get(route("admin.dashboard"))},z=()=>{if(!b.trim()){alert("Veuillez indiquer une raison de refus.");return}x.post(route("admin.appointments.reject",g.id),{rejection_reason:b}),m(!1),i(null),N("")},T=()=>{if(!f.trim()){alert("Veuillez indiquer une raison d'annulation.");return}x.post(route("admin.appointments.cancel",g.id),{admin_notes:f}),u(!1),i(null),w("")},E=s=>{confirm("Êtes-vous sûr de vouloir accepter ce rendez-vous ?")&&x.post(route("admin.appointments.accept",s.id))},F=()=>{d.put(route("admin.appointments.update",g.id),{onSuccess:()=>{h(!1),i(null),d.reset()}})},P=s=>{i(s),m(!0)},q=s=>{i(s),u(!0)},B=s=>{i(s),d.setData({admin_notes:s.admin_notes||"",preferred_date:s.preferred_date,preferred_time:s.preferred_time}),h(!0)},U=s=>{confirm("Marquer ce rendez-vous comme terminé ?")&&x.post(route("admin.appointments.complete",s.id))};return e.jsxs(H,{user:p.user,children:[e.jsx($,{title:"Tableau de bord - Administration"}),e.jsx("div",{className:"py-12",children:e.jsxs("div",{className:"max-w-7xl mx-auto sm:px-6 lg:px-8",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Tableau de bord"}),e.jsxs("p",{className:"text-gray-600 mt-2",children:["Bienvenue, ",p.user.name," (",p.user.role==="admin"?"Administrateur":"Assistant",")"]})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-6 mb-8",children:[e.jsxs("div",{className:"bg-white rounded-lg shadow p-6 text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-orange-500",children:c.pending}),e.jsx("div",{className:"text-sm text-gray-600 mt-2",children:"En attente"})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow p-6 text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-green-500",children:c.accepted}),e.jsx("div",{className:"text-sm text-gray-600 mt-2",children:"Acceptés"})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow p-6 text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-red-500",children:c.rejected}),e.jsx("div",{className:"text-sm text-gray-600 mt-2",children:"Refusés"})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow p-6 text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-gray-400",children:c.canceled}),e.jsx("div",{className:"text-sm text-gray-600 mt-2",children:"Annulés"})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow p-6 text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-blue-500",children:c.completed}),e.jsx("div",{className:"text-sm text-gray-600 mt-2",children:"Terminés"})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow p-6 text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-gray-500",children:c.expired}),e.jsx("div",{className:"text-sm text-gray-600 mt-2",children:"Expirés"})]})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow p-6 mb-8",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Statistiques sur 30 jours"}),e.jsx(L,{data:{title:"Évolution des rendez-vous sur 30 jours",series:[{name:"Rendez-vous",data:(k||[]).map(s=>({x:new Date(s.day).getTime(),y:s.count}))}]},type:"line"})]}),j&&j.length>0&&e.jsxs("div",{className:"bg-white rounded-lg shadow p-6 mb-8",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Prochains rendez-vous"}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Nom"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Date"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Heure"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Objet"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:j.map(s=>e.jsxs("tr",{children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:s.name}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:new Date(s.preferred_date).toLocaleDateString("fr-FR")}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:s.preferred_time}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:s.subject})]},s.id))})]})})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow p-6 mb-8",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Filtres des rendez-vous"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Statut"}),e.jsxs("select",{value:a.data.status,onChange:s=>a.setData("status",s.target.value),className:"w-full border-gray-300 rounded-md shadow-sm focus:border-blue-500 focus:ring-blue-500",children:[e.jsx("option",{value:"",children:"Tous les statuts"}),e.jsx("option",{value:"pending",children:"En attente"}),e.jsx("option",{value:"accepted",children:"Accepté"}),e.jsx("option",{value:"rejected",children:"Refusé"}),e.jsx("option",{value:"canceled",children:"Annulé"}),e.jsx("option",{value:"canceled_by_requester",children:"Annulé par le demandeur"}),e.jsx("option",{value:"expired",children:"Expiré"}),e.jsx("option",{value:"completed",children:"Terminé"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Priorité"}),e.jsxs("select",{value:a.data.priority,onChange:s=>a.setData("priority",s.target.value),className:"w-full border-gray-300 rounded-md shadow-sm focus:border-blue-500 focus:ring-blue-500",children:[e.jsx("option",{value:"",children:"Toutes les priorités"}),e.jsx("option",{value:"normal",children:"Normale"}),e.jsx("option",{value:"urgent",children:"Urgente"}),e.jsx("option",{value:"official",children:"Officielle"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Recherche"}),e.jsx("input",{type:"text",value:a.data.search,onChange:s=>a.setData("search",s.target.value),placeholder:"Nom, email ou objet...",className:"w-full border-gray-300 rounded-md shadow-sm focus:border-blue-500 focus:ring-blue-500"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Date de début"}),e.jsx("input",{type:"date",value:a.data.date_from,onChange:s=>a.setData("date_from",s.target.value),className:"w-full border-gray-300 rounded-md shadow-sm focus:border-blue-500 focus:ring-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Date de fin"}),e.jsx("input",{type:"date",value:a.data.date_to,onChange:s=>a.setData("date_to",s.target.value),className:"w-full border-gray-300 rounded-md shadow-sm focus:border-blue-500 focus:ring-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Tri"}),e.jsxs("select",{value:`${a.data.sort_by}-${a.data.sort_order}`,onChange:s=>{const[y,O]=s.target.value.split("-");a.setData("sort_by",y),a.setData("sort_order",O)},className:"w-full border-gray-300 rounded-md shadow-sm focus:border-blue-500 focus:ring-blue-500",children:[e.jsx("option",{value:"created_at-desc",children:"Plus récents"}),e.jsx("option",{value:"created_at-asc",children:"Plus anciens"}),e.jsx("option",{value:"preferred_date-asc",children:"Date croissante"}),e.jsx("option",{value:"preferred_date-desc",children:"Date décroissante"}),e.jsx("option",{value:"name-asc",children:"Nom A-Z"}),e.jsx("option",{value:"name-desc",children:"Nom Z-A"})]})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(o,{onClick:D,children:"Filtrer"}),e.jsx(l,{onClick:M,children:"Réinitialiser"})]})]}),r&&r.data&&r.data.length>0&&e.jsxs("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:[e.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:e.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Rendez-vous récents"})}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Nom"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Email"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Objet"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Date souhaitée"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Statut"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:r.data.map(s=>e.jsxs("tr",{children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:s.name}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:s.email}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:s.subject}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:[s.preferred_date," à ",s.preferred_time]}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx(V,{status:s.status})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:e.jsxs("div",{className:"flex space-x-2",children:[s.status==="pending"&&e.jsxs(e.Fragment,{children:[e.jsx(o,{onClick:()=>E(s),className:"text-xs px-2 py-1",children:"Accepter"}),e.jsx(l,{onClick:()=>P(s),className:"text-xs px-2 py-1",children:"Refuser"})]}),e.jsx(l,{onClick:()=>B(s),className:"text-xs px-2 py-1",children:"Modifier"}),s.status==="accepted"&&e.jsx(o,{onClick:()=>U(s),className:"text-xs px-2 py-1",children:"Terminer"}),s.status!=="completed"&&s.status!=="expired"&&e.jsx(l,{onClick:()=>q(s),className:"text-xs px-2 py-1",children:"Annuler"}),e.jsx(C,{href:route("admin.appointments.show",s.id),className:"text-blue-600 hover:text-blue-900 text-xs",children:"Voir"})]})})]},s.id))})]})}),r.links&&e.jsx("div",{className:"px-6 py-3 border-t border-gray-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"text-sm text-gray-700",children:["Affichage de ",r.from," à ",r.to," sur ",r.total," résultats"]}),e.jsx("div",{className:"flex space-x-2",children:r.links.map((s,y)=>e.jsx(C,{href:s.url,className:`px-3 py-2 text-sm rounded-md ${s.active?"bg-blue-500 text-white":"bg-white text-gray-700 hover:bg-gray-50"} ${s.url?"":"opacity-50 cursor-not-allowed"}`,dangerouslySetInnerHTML:{__html:s.label}},y))})]})})]})]})}),e.jsx(v,{show:S,onClose:()=>m(!1),children:e.jsxs("div",{className:"p-6",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Refuser le rendez-vous"}),e.jsx("textarea",{value:b,onChange:s=>N(s.target.value),placeholder:"Raison du refus...",className:"w-full border-gray-300 rounded-md shadow-sm focus:border-blue-500 focus:ring-blue-500",rows:"4"}),e.jsxs("div",{className:"mt-4 flex justify-end space-x-2",children:[e.jsx(l,{onClick:()=>m(!1),children:"Annuler"}),e.jsx(o,{onClick:z,children:"Refuser"})]})]})}),e.jsx(v,{show:R,onClose:()=>u(!1),children:e.jsxs("div",{className:"p-6",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Annuler le rendez-vous"}),e.jsx("textarea",{value:f,onChange:s=>w(s.target.value),placeholder:"Raison de l'annulation...",className:"w-full border-gray-300 rounded-md shadow-sm focus:border-blue-500 focus:ring-blue-500",rows:"4"}),e.jsxs("div",{className:"mt-4 flex justify-end space-x-2",children:[e.jsx(l,{onClick:()=>u(!1),children:"Annuler"}),e.jsx(o,{onClick:T,children:"Confirmer"})]})]})}),e.jsx(v,{show:A,onClose:()=>h(!1),children:e.jsxs("div",{className:"p-6",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Modifier le rendez-vous"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Notes administrateur"}),e.jsx("textarea",{value:d.data.admin_notes,onChange:s=>d.setData("admin_notes",s.target.value),className:"w-full border-gray-300 rounded-md shadow-sm focus:border-blue-500 focus:ring-blue-500",rows:"3"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Date préférée"}),e.jsx("input",{type:"date",value:d.data.preferred_date,onChange:s=>d.setData("preferred_date",s.target.value),className:"w-full border-gray-300 rounded-md shadow-sm focus:border-blue-500 focus:ring-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Heure préférée"}),e.jsx("input",{type:"time",value:d.data.preferred_time,onChange:s=>d.setData("preferred_time",s.target.value),className:"w-full border-gray-300 rounded-md shadow-sm focus:border-blue-500 focus:ring-blue-500"})]})]})]}),e.jsxs("div",{className:"mt-4 flex justify-end space-x-2",children:[e.jsx(l,{onClick:()=>h(!1),children:"Annuler"}),e.jsx(o,{onClick:F,children:"Mettre à jour"})]})]})})]})}export{se as default};
