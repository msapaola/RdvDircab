import{r as d,S as h,x as Z,j as e,Q as he}from"./app-Bzj_tZzK.js";import{P as p}from"./PrimaryButton-DcUdWHDd.js";import{S as g}from"./dialog-DWoDRj-b.js";import{M as N}from"./Modal-CbtZ6VIJ.js";import{D as ge}from"./DashboardMenu-D5Hwra6p.js";import{S as J}from"./SafeLink-A9K2pHkh.js";import{A as je}from"./AttachmentViewer-BHVcbAgF.js";import"./transition-DaEcfr68.js";import"./ApplicationLogo-BUquxWbh.js";import"./ResponsiveNavLink-BrVN0hRi.js";function Ae({appointments:n,stats:m,filters:x}){const[K,v]=d.useState(!1),[Y,w]=d.useState(!1),[ee,E]=d.useState(!1),[se,C]=d.useState(!1),[te,k]=d.useState(!1),[r,u]=d.useState(null),[o,y]=d.useState([]),[M,L]=d.useState(""),[T,P]=d.useState(""),[c,O]=d.useState(""),[_,$]=d.useState(""),[D,V]=d.useState("table"),[z,re]=d.useState(!1),[ae,A]=d.useState(!1),[R,q]=d.useState(!1),[a,U]=d.useState(null);d.useEffect(()=>{if(!z)return;const s=setInterval(()=>{h.reload({only:["appointments","stats"]})},3e4);return()=>clearInterval(s)},[z]);const l=Z({status:x.status||"",priority:x.priority||"",date_from:x.date_from||"",date_to:x.date_to||"",search:x.search||"",sort_by:x.sort_by||"created_at",sort_order:x.sort_order||"desc",per_page:x.per_page||20}),t=Z({name:"",email:"",phone:"",subject:"",message:"",preferred_date:"",preferred_time:"",priority:"normal",status:"pending",admin_notes:""}),le=()=>{l.get(route("admin.appointments.index"))},de=()=>{l.reset(),h.get(route("admin.appointments.index"))},ne=()=>{if(!M.trim()){alert("Veuillez indiquer une raison de refus.");return}h.post(route("admin.appointments.reject",r.id),{rejection_reason:M},{onSuccess:()=>{v(!1),u(null),L("")}})},ce=()=>{if(!T.trim()){alert("Veuillez indiquer une raison d'annulation.");return}h.post(route("admin.appointments.cancel",r.id),{admin_notes:T},{onSuccess:()=>{w(!1),u(null),P("")}})},B=s=>{U(s),A(!0)},ie=()=>{q(!0),h.post(route("admin.appointments.accept",a.id),{},{onSuccess:()=>{q(!1),A(!1),U(null)},onError:()=>{q(!1),alert("Une erreur est survenue lors de l'acceptation du rendez-vous.")}})},oe=s=>{confirm("Marquer ce rendez-vous comme terminé ?")&&h.post(route("admin.appointments.complete",s.id))},xe=()=>{t.put(route("admin.appointments.update",r.id),{onSuccess:()=>{C(!1),u(null),t.reset()}})},H=s=>{u(s);const i=f=>f?new Date(f).toISOString().split("T")[0]:"";t.setData({name:s.name,email:s.email,phone:s.phone,subject:s.subject,message:s.message||"",preferred_date:i(s.preferred_date),preferred_time:s.preferred_time,priority:s.priority,status:s.status,admin_notes:s.admin_notes||""}),C(!0)},me=()=>{if(!c){alert("Veuillez sélectionner une action.");return}if(o.length===0){alert("Veuillez sélectionner au moins un rendez-vous.");return}if((c==="reject"||c==="cancel")&&!_.trim()){alert("Veuillez indiquer une raison.");return}const s={appointment_ids:o,action:c};(c==="reject"||c==="cancel")&&_.trim()&&(s.reason=_.trim()),h.post(route("admin.appointments.bulk-action"),s,{onSuccess:()=>{k(!1),y([]),O(""),$("")},onError:i=>{alert("Erreur lors de l'exécution de l'action en lot.")}})},W=s=>{y(i=>i.includes(s)?i.filter(f=>f!==s):[...i,s])},G=()=>{o.length===n.data.length?y([]):y(n.data.map(s=>s.id))},Q=s=>{u(s),v(!0)},ue=s=>{u(s),w(!0)},X=s=>{u(s),E(!0)},S=s=>{switch(s){case"urgent":return"URGENT";case"official":return"OFFICIEL";case"normal":return"NORMALE";default:return"NORMALE"}},F=s=>{switch(s){case"urgent":return{text:"URGENT",class:"text-red-700 bg-red-100 border-red-300"};case"official":return{text:"OFFICIEL",class:"text-blue-700 bg-blue-100 border-blue-300"};case"normal":return{text:"NORMALE",class:"text-gray-700 bg-gray-100 border-gray-300"};default:return{text:"NORMALE",class:"text-gray-700 bg-gray-100 border-gray-300"}}},j=s=>{switch(s){case"pending":return{text:"EN ATTENTE",class:"text-orange-700 bg-orange-100 border-orange-300"};case"accepted":return{text:"ACCEPTÉ",class:"text-green-700 bg-green-100 border-green-300"};case"rejected":return{text:"REFUSÉ",class:"text-red-700 bg-red-100 border-red-300"};case"canceled":return{text:"ANNULÉ",class:"text-gray-700 bg-gray-100 border-gray-300"};case"canceled_by_requester":return{text:"ANNULÉ PAR LE CLIENT",class:"text-gray-700 bg-gray-100 border-gray-300"};case"completed":return{text:"TERMINÉ",class:"text-blue-700 bg-blue-100 border-blue-300"};case"expired":return{text:"EXPIRÉ",class:"text-yellow-700 bg-yellow-100 border-yellow-300"};default:return{text:"EN ATTENTE",class:"text-orange-700 bg-orange-100 border-orange-300"}}},b=s=>new Date(s).toLocaleDateString("fr-FR",{year:"numeric",month:"long",day:"numeric"}),I=s=>s;return e.jsxs(e.Fragment,{children:[e.jsx(he,{title:"Gestion des rendez-vous - Administration"}),e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx(ge,{}),e.jsx("header",{className:"bg-white shadow-sm border-b mb-8",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Gestion des rendez-vous"}),e.jsx("p",{className:"text-gray-600 mt-2",children:"Outil de gestion efficace des demandes de rendez-vous"})]}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",id:"autoRefresh",checked:z,onChange:s=>re(s.target.checked),className:"rounded border-gray-300"}),e.jsx("label",{htmlFor:"autoRefresh",className:"text-sm text-gray-600",children:"Auto-refresh"})]}),e.jsx(J,{href:route("admin.dashboard"),className:"text-blue-600 hover:text-blue-800 text-sm font-medium",children:"← Retour au tableau de bord"})]})]})})}),e.jsxs("main",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-6 gap-4 mb-8",children:[e.jsxs("div",{className:"bg-white rounded-lg shadow p-4 text-center border-l-4 border-gray-400",children:[e.jsx("div",{className:"text-2xl font-bold text-gray-900",children:m.total}),e.jsx("div",{className:"text-sm text-gray-600",children:"Total"})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow p-4 text-center border-l-4 border-orange-400",children:[e.jsx("div",{className:"text-2xl font-bold text-orange-500",children:m.pending}),e.jsx("div",{className:"text-sm text-gray-600",children:"En attente"}),m.pending>0&&e.jsx("div",{className:"text-xs text-orange-600 mt-1",children:"⚠️ Action requise"})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow p-4 text-center border-l-4 border-green-400",children:[e.jsx("div",{className:"text-2xl font-bold text-green-500",children:m.accepted}),e.jsx("div",{className:"text-sm text-gray-600",children:"Acceptés"})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow p-4 text-center border-l-4 border-red-400",children:[e.jsx("div",{className:"text-2xl font-bold text-red-500",children:m.rejected}),e.jsx("div",{className:"text-sm text-gray-600",children:"Refusés"})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow p-4 text-center border-l-4 border-gray-300",children:[e.jsx("div",{className:"text-2xl font-bold text-gray-400",children:m.canceled}),e.jsx("div",{className:"text-sm text-gray-600",children:"Annulés"})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow p-4 text-center border-l-4 border-blue-400",children:[e.jsx("div",{className:"text-2xl font-bold text-blue-500",children:m.completed}),e.jsx("div",{className:"text-sm text-gray-600",children:"Terminés"})]})]}),o.length>0&&e.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 mb-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("span",{className:"text-blue-800 font-medium",children:[o.length," rendez-vous sélectionné(s)"]}),e.jsx("button",{onClick:()=>k(!0),className:"bg-blue-600 text-white px-4 py-2 rounded-md text-sm font-medium hover:bg-blue-700",children:"Actions en lot"})]}),e.jsx("button",{onClick:()=>y([]),className:"text-blue-600 hover:text-blue-800 text-sm",children:"Annuler la sélection"})]})}),e.jsxs("div",{className:"bg-white rounded-lg shadow p-6 mb-8",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Filtres et recherche"}),e.jsx("div",{className:"flex items-center space-x-4",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{onClick:()=>V("table"),className:`px-3 py-1 rounded-md text-sm font-medium ${D==="table"?"bg-blue-100 text-blue-700":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,children:"Tableau"}),e.jsx("button",{onClick:()=>V("cards"),className:`px-3 py-1 rounded-md text-sm font-medium ${D==="cards"?"bg-blue-100 text-blue-700":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,children:"Cartes"})]})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Statut"}),e.jsxs("select",{value:l.data.status,onChange:s=>l.setData("status",s.target.value),className:"w-full border-gray-300 rounded-md shadow-sm focus:border-blue-500 focus:ring-blue-500",children:[e.jsx("option",{value:"",children:"Tous les statuts"}),e.jsx("option",{value:"pending",children:"En attente"}),e.jsx("option",{value:"accepted",children:"Accepté"}),e.jsx("option",{value:"rejected",children:"Refusé"}),e.jsx("option",{value:"canceled",children:"Annulé"}),e.jsx("option",{value:"canceled_by_requester",children:"Annulé par le demandeur"}),e.jsx("option",{value:"expired",children:"Expiré"}),e.jsx("option",{value:"completed",children:"Terminé"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Priorité"}),e.jsxs("select",{value:l.data.priority,onChange:s=>l.setData("priority",s.target.value),className:"w-full border-gray-300 rounded-md shadow-sm focus:border-blue-500 focus:ring-blue-500",children:[e.jsx("option",{value:"",children:"Toutes les priorités"}),e.jsx("option",{value:"normal",children:"Normale"}),e.jsx("option",{value:"urgent",children:"Urgente"}),e.jsx("option",{value:"official",children:"Officielle"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Recherche"}),e.jsx("input",{type:"text",value:l.data.search,onChange:s=>l.setData("search",s.target.value),placeholder:"Nom, email ou objet...",className:"w-full border-gray-300 rounded-md shadow-sm focus:border-blue-500 focus:ring-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Par page"}),e.jsxs("select",{value:l.data.per_page,onChange:s=>l.setData("per_page",s.target.value),className:"w-full border-gray-300 rounded-md shadow-sm focus:border-blue-500 focus:ring-blue-500",children:[e.jsx("option",{value:"10",children:"10"}),e.jsx("option",{value:"20",children:"20"}),e.jsx("option",{value:"50",children:"50"}),e.jsx("option",{value:"100",children:"100"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Date de début"}),e.jsx("input",{type:"date",value:l.data.date_from,onChange:s=>l.setData("date_from",s.target.value),className:"w-full border-gray-300 rounded-md shadow-sm focus:border-blue-500 focus:ring-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Date de fin"}),e.jsx("input",{type:"date",value:l.data.date_to,onChange:s=>l.setData("date_to",s.target.value),className:"w-full border-gray-300 rounded-md shadow-sm focus:border-blue-500 focus:ring-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Tri"}),e.jsxs("select",{value:`${l.data.sort_by}-${l.data.sort_order}`,onChange:s=>{const[i,f]=s.target.value.split("-");l.setData("sort_by",i),l.setData("sort_order",f)},className:"w-full border-gray-300 rounded-md shadow-sm focus:border-blue-500 focus:ring-blue-500",children:[e.jsx("option",{value:"created_at-desc",children:"Plus récents"}),e.jsx("option",{value:"created_at-asc",children:"Plus anciens"}),e.jsx("option",{value:"preferred_date-asc",children:"Date RDV (croissant)"}),e.jsx("option",{value:"preferred_date-desc",children:"Date RDV (décroissant)"}),e.jsx("option",{value:"name-asc",children:"Nom (A-Z)"}),e.jsx("option",{value:"name-desc",children:"Nom (Z-A)"}),e.jsx("option",{value:"priority-desc",children:"Priorité (haute → basse)"}),e.jsx("option",{value:"priority-asc",children:"Priorité (basse → haute)"})]})]})]}),e.jsxs("div",{className:"flex space-x-3",children:[e.jsx(p,{onClick:le,children:"🔍 Appliquer les filtres"}),e.jsx(g,{onClick:de,children:"🔄 Réinitialiser"})]})]}),D==="table"&&e.jsxs("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:[e.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("h2",{className:"text-lg font-semibold text-gray-900",children:["Rendez-vous (",n.total,")"]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",checked:o.length===n.data.length&&n.data.length>0,onChange:G,className:"rounded border-gray-300"}),e.jsx("span",{className:"text-sm text-gray-600",children:"Sélectionner tout"})]})]})}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:e.jsx("input",{type:"checkbox",checked:o.length===n.data.length&&n.data.length>0,onChange:G,className:"rounded border-gray-300"})}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Demandeur"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Objet"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Date/Heure"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Priorité"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Statut"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:n.data.map(s=>e.jsxs("tr",{className:`hover:bg-gray-50 ${s.status==="pending"?"bg-orange-50":""}`,children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("input",{type:"checkbox",checked:o.includes(s.id),onChange:()=>W(s.id),className:"rounded border-gray-300"})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium text-gray-900",children:s.name}),e.jsx("div",{className:"text-sm text-gray-500",children:s.email}),e.jsx("div",{className:"text-xs text-gray-400",children:s.phone})]})}),e.jsxs("td",{className:"px-6 py-4",children:[e.jsx("div",{className:"text-sm text-gray-900 max-w-xs truncate",children:s.subject}),e.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["Créé le ",b(s.created_at)]})]}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[e.jsx("div",{className:"text-sm text-gray-900",children:b(s.preferred_date)}),e.jsx("div",{className:"text-sm text-gray-500",children:I(s.preferred_time)})]}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full border ${F(s.priority).class}`,children:S(s.priority)})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full border ${j(s.status).class}`,children:j(s.status).text})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:e.jsxs("div",{className:"flex space-x-2",children:[e.jsxs("button",{onClick:()=>X(s),className:"text-blue-600 hover:text-blue-900 flex items-center",children:["👁️ Voir",s.attachments&&s.attachments.length>0&&e.jsxs("span",{className:"ml-1 text-xs bg-blue-100 text-blue-800 px-1.5 py-0.5 rounded-full",children:["📎 ",s.attachments.length]})]}),e.jsx("button",{onClick:()=>H(s),className:"text-purple-600 hover:text-purple-900",children:"✏️ Modifier"}),s.status==="pending"&&e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:()=>B(s),className:"text-green-600 hover:text-green-900",children:"✅ Accepter"}),e.jsx("button",{onClick:()=>Q(s),className:"text-red-600 hover:text-red-900",children:"❌ Refuser"})]}),s.status==="accepted"&&e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:()=>oe(s),className:"text-blue-600 hover:text-blue-900",children:"✅ Terminer"}),e.jsx("button",{onClick:()=>ue(s),className:"text-gray-600 hover:text-gray-900",children:"🚫 Annuler"})]})]})})]},s.id))})]})}),n.links&&e.jsx("div",{className:"px-6 py-3 border-t border-gray-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"text-sm text-gray-700",children:["Affichage de ",n.from," à ",n.to," sur ",n.total," résultats"]}),e.jsx("div",{className:"flex space-x-2",children:n.links.map((s,i)=>s.url?e.jsx(J,{href:s.url,className:`px-3 py-2 text-sm rounded-md ${s.active?"bg-blue-500 text-white":"bg-white text-gray-700 hover:bg-gray-50"}`,dangerouslySetInnerHTML:{__html:s.label}},i):e.jsx("span",{className:`px-3 py-2 text-sm rounded-md opacity-50 cursor-not-allowed ${s.active?"bg-blue-500 text-white":"bg-white text-gray-700"}`,dangerouslySetInnerHTML:{__html:s.label}},i))})]})})]}),D==="cards"&&e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:n.data.map(s=>e.jsx("div",{className:`bg-white rounded-lg shadow-md border-l-4 ${s.status==="pending"?"border-orange-400":s.status==="accepted"?"border-green-400":s.status==="rejected"?"border-red-400":s.status==="completed"?"border-blue-400":"border-gray-400"}`,children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:s.name}),e.jsx("p",{className:"text-sm text-gray-600",children:s.email}),e.jsx("p",{className:"text-xs text-gray-500",children:s.phone})]}),e.jsx("input",{type:"checkbox",checked:o.includes(s.id),onChange:()=>W(s.id),className:"rounded border-gray-300"})]}),e.jsxs("div",{className:"mb-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("p",{className:"text-sm text-gray-900 font-medium",children:s.subject}),s.attachments&&s.attachments.length>0&&e.jsxs("span",{className:"text-xs text-blue-600 bg-blue-50 px-2 py-1 rounded-full",children:["📎 ",s.attachments.length," fichier(s)"]})]}),e.jsxs("p",{className:"text-xs text-gray-600",children:[s.message&&s.message.substring(0,100),"..."]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500",children:"Date"}),e.jsx("p",{className:"text-sm font-medium",children:b(s.preferred_date)})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500",children:"Heure"}),e.jsx("p",{className:"text-sm font-medium",children:I(s.preferred_time)})]})]}),e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full border ${F(s.priority).class}`,children:S(s.priority)}),e.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full border ${j(s.status).class}`,children:j(s.status).text})]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsxs("button",{onClick:()=>X(s),className:"flex-1 bg-blue-600 text-white px-3 py-2 rounded-md text-sm font-medium hover:bg-blue-700 flex items-center justify-center",children:["👁️ Détails",s.attachments&&s.attachments.length>0&&e.jsxs("span",{className:"ml-1 text-xs bg-blue-200 text-blue-800 px-1.5 py-0.5 rounded-full",children:["📎 ",s.attachments.length]})]}),e.jsx("button",{onClick:()=>H(s),className:"bg-purple-600 text-white px-3 py-2 rounded-md text-sm font-medium hover:bg-purple-700",children:"✏️ Modifier"}),s.status==="pending"&&e.jsxs("div",{className:"flex space-x-1",children:[e.jsx("button",{onClick:()=>B(s),className:"bg-green-600 text-white px-2 py-2 rounded-md text-sm hover:bg-green-700",title:"Accepter",children:"✅"}),e.jsx("button",{onClick:()=>Q(s),className:"bg-red-600 text-white px-2 py-2 rounded-md text-sm hover:bg-red-700",title:"Refuser",children:"❌"})]})]})]})},s.id))})]})]}),e.jsx(N,{show:ee,onClose:()=>E(!1),maxWidth:"6xl",children:r&&e.jsxs("div",{className:"p-6",children:[e.jsxs("h3",{className:"text-lg font-medium text-gray-900 mb-6",children:["Détails du rendez-vous - ",r.name]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-3",children:"Informations du demandeur"}),e.jsxs("div",{className:"space-y-3 text-sm",children:[e.jsxs("p",{children:[e.jsx("span",{className:"font-medium",children:"Nom :"})," ",r.name]}),e.jsxs("p",{children:[e.jsx("span",{className:"font-medium",children:"Email :"})," ",r.email]}),e.jsxs("p",{children:[e.jsx("span",{className:"font-medium",children:"Téléphone :"})," ",r.phone]}),e.jsxs("p",{children:[e.jsx("span",{className:"font-medium",children:"Date de création :"})," ",b(r.created_at)]})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-3",children:"Détails du rendez-vous"}),e.jsxs("div",{className:"space-y-3 text-sm",children:[e.jsxs("p",{children:[e.jsx("span",{className:"font-medium",children:"Objet :"})," ",r.subject]}),e.jsxs("p",{children:[e.jsx("span",{className:"font-medium",children:"Date souhaitée :"})," ",b(r.preferred_date)]}),e.jsxs("p",{children:[e.jsx("span",{className:"font-medium",children:"Heure souhaitée :"})," ",I(r.preferred_time)]}),e.jsxs("p",{children:[e.jsx("span",{className:"font-medium",children:"Priorité :"}),e.jsx("span",{className:`ml-1 inline-flex px-2 py-1 text-xs font-semibold rounded-full border ${F(r.priority).class}`,children:S(r.priority)})]}),e.jsxs("p",{children:[e.jsx("span",{className:"font-medium",children:"Statut :"}),e.jsx("span",{className:`ml-1 inline-flex px-2 py-1 text-xs font-semibold rounded-full border ${j(r.status).class}`,children:j(r.status).text})]})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-3",children:"Informations système"}),e.jsxs("div",{className:"space-y-3 text-sm",children:[e.jsxs("p",{children:[e.jsx("span",{className:"font-medium",children:"ID :"})," ",r.id]}),e.jsxs("p",{children:[e.jsx("span",{className:"font-medium",children:"Token :"})," ",e.jsx("code",{className:"text-xs bg-gray-100 px-1 rounded",children:r.secure_token})]}),e.jsxs("p",{children:[e.jsx("span",{className:"font-medium",children:"IP :"})," ",r.ip_address]}),e.jsxs("p",{children:[e.jsx("span",{className:"font-medium",children:"Modifié le :"})," ",b(r.updated_at)]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8 mt-8",children:[r.message&&e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-3",children:"Message du demandeur"}),e.jsx("div",{className:"bg-gray-50 p-4 rounded-md",children:e.jsx("p",{className:"text-sm text-gray-700 whitespace-pre-wrap",children:r.message})})]}),r.rejection_reason&&e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-red-900 mb-3",children:"Raison du refus"}),e.jsx("div",{className:"bg-red-50 p-4 rounded-md",children:e.jsx("p",{className:"text-sm text-red-700",children:r.rejection_reason})})]}),r.admin_notes&&e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-3",children:"Notes administratives"}),e.jsx("div",{className:"bg-blue-50 p-4 rounded-md",children:e.jsx("p",{className:"text-sm text-blue-700",children:r.admin_notes})})]})]}),r.attachments&&r.attachments.length>0&&e.jsxs("div",{className:"mt-8",children:[e.jsxs("h4",{className:"font-medium text-gray-900 mb-4",children:["Pièces jointes (",r.attachments.length,")"]}),e.jsx("div",{className:"bg-gray-50 rounded-lg p-4",children:e.jsx(je,{attachments:r.attachments,appointmentId:r.id})})]}),e.jsx("div",{className:"mt-6 flex justify-end space-x-3",children:e.jsx(g,{onClick:()=>E(!1),children:"Fermer"})})]})}),e.jsx(N,{show:se,onClose:()=>C(!1),maxWidth:"4xl",children:r&&e.jsxs("div",{className:"p-6",children:[e.jsxs("h3",{className:"text-lg font-medium text-gray-900 mb-6",children:["Modifier le rendez-vous - ",r.name]}),e.jsxs("form",{onSubmit:s=>{s.preventDefault(),xe()},children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsx("h4",{className:"font-medium text-gray-900 border-b pb-2",children:"Informations du demandeur"}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nom complet *"}),e.jsx("input",{type:"text",value:t.data.name,onChange:s=>t.setData("name",s.target.value),className:"w-full border-gray-300 rounded-md shadow-sm focus:border-blue-500 focus:ring-blue-500",required:!0}),t.errors.name&&e.jsx("p",{className:"text-red-600 text-xs mt-1",children:t.errors.name})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email *"}),e.jsx("input",{type:"email",value:t.data.email,onChange:s=>t.setData("email",s.target.value),className:"w-full border-gray-300 rounded-md shadow-sm focus:border-blue-500 focus:ring-blue-500",required:!0}),t.errors.email&&e.jsx("p",{className:"text-red-600 text-xs mt-1",children:t.errors.email})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Téléphone *"}),e.jsx("input",{type:"tel",value:t.data.phone,onChange:s=>t.setData("phone",s.target.value),className:"w-full border-gray-300 rounded-md shadow-sm focus:border-blue-500 focus:ring-blue-500",required:!0}),t.errors.phone&&e.jsx("p",{className:"text-red-600 text-xs mt-1",children:t.errors.phone})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h4",{className:"font-medium text-gray-900 border-b pb-2",children:"Détails du rendez-vous"}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Objet *"}),e.jsx("input",{type:"text",value:t.data.subject,onChange:s=>t.setData("subject",s.target.value),className:"w-full border-gray-300 rounded-md shadow-sm focus:border-blue-500 focus:ring-blue-500",required:!0}),t.errors.subject&&e.jsx("p",{className:"text-red-600 text-xs mt-1",children:t.errors.subject})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Date souhaitée *"}),e.jsx("input",{type:"date",value:t.data.preferred_date,onChange:s=>t.setData("preferred_date",s.target.value),className:"w-full border-gray-300 rounded-md shadow-sm focus:border-blue-500 focus:ring-blue-500",required:!0}),t.errors.preferred_date&&e.jsx("p",{className:"text-red-600 text-xs mt-1",children:t.errors.preferred_date})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Heure souhaitée *"}),e.jsx("input",{type:"time",value:t.data.preferred_time,onChange:s=>t.setData("preferred_time",s.target.value),className:"w-full border-gray-300 rounded-md shadow-sm focus:border-blue-500 focus:ring-blue-500",required:!0}),t.errors.preferred_time&&e.jsx("p",{className:"text-red-600 text-xs mt-1",children:t.errors.preferred_time})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Priorité *"}),e.jsxs("select",{value:t.data.priority,onChange:s=>t.setData("priority",s.target.value),className:"w-full border-gray-300 rounded-md shadow-sm focus:border-blue-500 focus:ring-blue-500",required:!0,children:[e.jsx("option",{value:"normal",children:"NORMALE"}),e.jsx("option",{value:"urgent",children:"URGENT"}),e.jsx("option",{value:"official",children:"OFFICIEL"})]}),t.errors.priority&&e.jsx("p",{className:"text-red-600 text-xs mt-1",children:t.errors.priority})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Statut *"}),e.jsxs("select",{value:t.data.status,onChange:s=>t.setData("status",s.target.value),className:"w-full border-gray-300 rounded-md shadow-sm focus:border-blue-500 focus:ring-blue-500",required:!0,children:[e.jsx("option",{value:"pending",children:"EN ATTENTE"}),e.jsx("option",{value:"accepted",children:"ACCEPTÉ"}),e.jsx("option",{value:"rejected",children:"REFUSÉ"}),e.jsx("option",{value:"canceled",children:"ANNULÉ"}),e.jsx("option",{value:"completed",children:"TERMINÉ"}),e.jsx("option",{value:"expired",children:"EXPIRÉ"})]}),t.errors.status&&e.jsx("p",{className:"text-red-600 text-xs mt-1",children:t.errors.status})]})]})]})]}),e.jsxs("div",{className:"mt-6 space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Message du demandeur"}),e.jsx("textarea",{value:t.data.message,onChange:s=>t.setData("message",s.target.value),className:"w-full border-gray-300 rounded-md shadow-sm focus:border-blue-500 focus:ring-blue-500",rows:"3",placeholder:"Message du demandeur..."}),t.errors.message&&e.jsx("p",{className:"text-red-600 text-xs mt-1",children:t.errors.message})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Notes administratives"}),e.jsx("textarea",{value:t.data.admin_notes,onChange:s=>t.setData("admin_notes",s.target.value),className:"w-full border-gray-300 rounded-md shadow-sm focus:border-blue-500 focus:ring-blue-500",rows:"3",placeholder:"Notes administratives..."}),t.errors.admin_notes&&e.jsx("p",{className:"text-red-600 text-xs mt-1",children:t.errors.admin_notes})]})]}),e.jsxs("div",{className:"mt-6 flex justify-end space-x-3",children:[e.jsx(g,{type:"button",onClick:()=>C(!1),children:"Annuler"}),e.jsx(p,{type:"submit",disabled:t.processing,children:t.processing?"Enregistrement...":"Enregistrer les modifications"})]})]})]})}),e.jsx(N,{show:K,onClose:()=>v(!1),maxWidth:"md",children:e.jsxs("div",{className:"p-6",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Refuser le rendez-vous"}),e.jsxs("p",{className:"text-sm text-gray-600 mb-4",children:["Veuillez indiquer la raison du refus pour le rendez-vous de ",e.jsx("strong",{children:r==null?void 0:r.name}),"."]}),e.jsx("textarea",{value:M,onChange:s=>L(s.target.value),placeholder:"Raison du refus...",className:"w-full border-gray-300 rounded-md shadow-sm focus:border-blue-500 focus:ring-blue-500",rows:"4"}),e.jsxs("div",{className:"mt-6 flex justify-end space-x-3",children:[e.jsx(g,{onClick:()=>v(!1),children:"Annuler"}),e.jsx(p,{onClick:ne,children:"Confirmer le refus"})]})]})}),e.jsx(N,{show:Y,onClose:()=>w(!1),maxWidth:"md",children:e.jsxs("div",{className:"p-6",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Annuler le rendez-vous"}),e.jsxs("p",{className:"text-sm text-gray-600 mb-4",children:["Veuillez indiquer la raison de l'annulation pour le rendez-vous de ",e.jsx("strong",{children:r==null?void 0:r.name}),"."]}),e.jsx("textarea",{value:T,onChange:s=>P(s.target.value),placeholder:"Raison de l'annulation...",className:"w-full border-gray-300 rounded-md shadow-sm focus:border-blue-500 focus:ring-blue-500",rows:"4"}),e.jsxs("div",{className:"mt-6 flex justify-end space-x-3",children:[e.jsx(g,{onClick:()=>w(!1),children:"Annuler"}),e.jsx(p,{onClick:ce,children:"Confirmer l'annulation"})]})]})}),e.jsx(N,{show:te,onClose:()=>k(!1),maxWidth:"md",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:["Actions en lot (",o.length," rendez-vous)"]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Action à effectuer"}),e.jsxs("select",{value:c,onChange:s=>O(s.target.value),className:"w-full border-gray-300 rounded-md shadow-sm focus:border-blue-500 focus:ring-blue-500",children:[e.jsx("option",{value:"",children:"Sélectionner une action"}),e.jsx("option",{value:"accept",children:"Accepter"}),e.jsx("option",{value:"reject",children:"Refuser"}),e.jsx("option",{value:"cancel",children:"Annuler"}),e.jsx("option",{value:"complete",children:"Marquer comme terminé"})]})]}),(c==="reject"||c==="cancel")&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:c==="reject"?"Raison du refus":"Raison de l'annulation"}),e.jsx("textarea",{value:_,onChange:s=>$(s.target.value),placeholder:`Raison du ${c==="reject"?"refus":"annulation"}...`,className:"w-full border-gray-300 rounded-md shadow-sm focus:border-blue-500 focus:ring-blue-500",rows:"3"})]})]}),e.jsxs("div",{className:"mt-6 flex justify-end space-x-3",children:[e.jsx(g,{onClick:()=>k(!1),children:"Annuler"}),e.jsx(p,{onClick:me,children:"Exécuter l'action"})]})]})}),e.jsx(N,{show:ae,onClose:()=>!R&&A(!1),maxWidth:"md",children:e.jsx("div",{className:"p-6",children:e.jsx("div",{className:"text-center",children:R?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"mx-auto flex items-center justify-center h-12 w-12 rounded-full bg-blue-100 mb-4",children:e.jsxs("svg",{className:"animate-spin h-6 w-6 text-blue-600",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]})}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Traitement en cours..."}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[e.jsx("div",{className:"w-2 h-2 bg-blue-600 rounded-full animate-pulse"}),e.jsx("span",{className:"text-sm text-gray-600",children:"Mise à jour du statut"})]}),e.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[e.jsx("div",{className:"w-2 h-2 bg-blue-600 rounded-full animate-pulse",style:{animationDelay:"0.2s"}}),e.jsx("span",{className:"text-sm text-gray-600",children:"Envoi de l'email de confirmation"})]}),e.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[e.jsx("div",{className:"w-2 h-2 bg-blue-600 rounded-full animate-pulse",style:{animationDelay:"0.4s"}}),e.jsx("span",{className:"text-sm text-gray-600",children:"Finalisation..."})]})]}),e.jsx("p",{className:"text-xs text-gray-500 mt-4",children:"Veuillez patienter, cette opération peut prendre quelques secondes."})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"mx-auto flex items-center justify-center h-12 w-12 rounded-full bg-green-100 mb-4",children:e.jsx("svg",{className:"h-6 w-6 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M5 13l4 4L19 7"})})}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Accepter le rendez-vous"}),e.jsxs("p",{className:"text-sm text-gray-600 mb-6",children:["Êtes-vous sûr de vouloir accepter le rendez-vous de ",e.jsx("strong",{children:a==null?void 0:a.name})," ?"]}),e.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 mb-6",children:[e.jsx("h4",{className:"text-sm font-medium text-blue-900 mb-2",children:"Détails du rendez-vous :"}),e.jsxs("div",{className:"text-sm text-blue-800 space-y-1",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Objet :"})," ",a==null?void 0:a.subject]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Date :"})," ",a!=null&&a.preferred_date?new Date(a.preferred_date).toLocaleDateString("fr-FR",{day:"2-digit",month:"2-digit",year:"numeric"}):"Non définie"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Heure :"})," ",(a==null?void 0:a.preferred_time)||"Non définie"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Priorité :"})," ",a!=null&&a.priority?S(a.priority):"Non définie"]})]})]}),e.jsx("p",{className:"text-xs text-gray-500 mb-6",children:"Un email de confirmation sera automatiquement envoyé au demandeur."}),e.jsxs("div",{className:"flex justify-end space-x-3",children:[e.jsx(g,{onClick:()=>A(!1),disabled:R,children:"Annuler"}),e.jsx(p,{onClick:ie,disabled:R,className:"bg-green-600 hover:bg-green-700 focus:ring-green-500",children:"Accepter le rendez-vous"})]})]})})})})]})}export{Ae as default};
